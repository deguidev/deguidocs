---
title: 游듹 05. Configuraci칩n avanzada
description: Aprende a personalizar y configurar Ziggy.js de manera avanzada
---

import { Code } from '@astrojs/starlight/components';
import { Tabs, TabItem } from '@astrojs/starlight/components';
import { Badge } from '@astrojs/starlight/components';
import { Aside } from '@astrojs/starlight/components';

## Personalizaci칩n del archivo ziggy.php

El archivo de configuraci칩n `ziggy.php` es el coraz칩n de la personalizaci칩n de Ziggy. Este archivo se publica en tu directorio `config` cuando ejecutas el comando `php artisan ziggy:generate`. Veamos c칩mo puedes personalizarlo para adaptarlo a tus necesidades.

### Estructura b치sica del archivo de configuraci칩n

<Code code={`<?php
// config/ziggy.php

return [
    // Rutas que se deben incluir en el objeto JavaScript
    'only' => [
        'login',
        'logout',
        'home',
        'api.*',
    ],

    // Rutas que se deben excluir del objeto JavaScript
    'except' => [
        'admin.*',
        'debug.*',
    ],

    // Grupos de rutas seg칰n el entorno
    'groups' => [
        'admin' => [
            'admin.*',
        ],
        'api' => [
            'api.*',
        ],
    ],

    // URL base para generar las rutas
    'url' => env('APP_URL'),

    // Configuraci칩n para entornos multiling칲es
    'locale' => true,
];
`} lang="php" title="Archivo de configuraci칩n ziggy.php" />

### Opciones de configuraci칩n principales

<Tabs>
  <TabItem label="only">
    La opci칩n `only` te permite especificar qu칠 rutas deben incluirse en el objeto JavaScript. Esto es 칰til para reducir el tama침o del objeto Ziggy y mejorar el rendimiento.

    ```php
    'only' => [
        'login',
        'logout',
        'home',
        'api.*',  // Incluye todas las rutas que comienzan con 'api.'
    ],
    ```

    <Aside type="tip">
      Puedes usar patrones con comodines como `'api.*'` para incluir grupos completos de rutas.
    </Aside>
  </TabItem>
  
  <TabItem label="except">
    La opci칩n `except` te permite especificar qu칠 rutas deben excluirse del objeto JavaScript. Esto es 칰til cuando quieres incluir la mayor칤a de las rutas pero excluir algunas espec칤ficas.

    ```php
    'except' => [
        'admin.*',  // Excluye todas las rutas administrativas
        'debug.*',  // Excluye rutas de depuraci칩n
    ],
    ```

    <Aside type="caution">
      Si especificas tanto `only` como `except`, `only` tiene prioridad y `except` se ignorar치.
    </Aside>
  </TabItem>
  
  <TabItem label="groups">
    La opci칩n `groups` te permite definir grupos de rutas que pueden ser cargados de forma independiente.

    ```php
    'groups' => [
        'admin' => [
            'admin.*',
            'users.*',
        ],
        'api' => [
            'api.*',
        ],
    ],
    ```
  </TabItem>
  
  <TabItem label="url">
    La opci칩n `url` te permite especificar la URL base para generar las rutas.

    ```php
    'url' => env('APP_URL'),
    ```

    <Aside>
      Por defecto, Ziggy usa `url()` para determinar la URL base, pero puedes sobrescribirla aqu칤.
    </Aside>
  </TabItem>
</Tabs>

## Selecci칩n de rutas espec칤ficas para exportar

Una de las caracter칤sticas m치s potentes de Ziggy es la capacidad de controlar qu칠 rutas se exportan al frontend. Esto es crucial para:

1. **Seguridad**: Evitar exponer rutas sensibles al frontend
2. **Rendimiento**: Reducir el tama침o del objeto JavaScript
3. **Organizaci칩n**: Mantener separadas las rutas seg칰n su prop칩sito

### Filtrado de rutas con only y except

<Code code={`<?php
// config/ziggy.php

return [
    'only' => [
        // Rutas espec칤ficas por nombre
        'users.index',
        'users.show',
        'products.*',  // Todas las rutas de productos
        
        // Rutas con patrones
        'api.v1.*',    // Todas las rutas de API v1
    ],
];
`} lang="php" title="Filtrado de rutas con only" />

### Ejemplo pr치ctico: Separar rutas p칰blicas y administrativas

<Code code={`<?php
// config/ziggy.php

return [
    'groups' => [
        'public' => [
            'login',
            'register',
            'password.*',
            'products.*',
            'cart.*',
            'checkout.*',
        ],
        'admin' => [
            'admin.*',
            'users.*',
            'roles.*',
            'permissions.*',
        ],
    ],
];
`} lang="php" title="Separaci칩n de rutas por grupos" />

Para usar un grupo espec칤fico en tu frontend:

<Tabs>
  <TabItem label="Blade">
    ```php
    @routes('public')
    ```
  </TabItem>
  
  <TabItem label="JavaScript">
    ```js
    // Generar el archivo para un grupo espec칤fico
    // php artisan ziggy:generate --group=public
    
    import route from './ziggy-public';
    ```
  </TabItem>
</Tabs>

## A침adir middleware o grupos de rutas seg칰n el entorno

Ziggy te permite configurar diferentes comportamientos seg칰n el entorno de ejecuci칩n de tu aplicaci칩n. Esto es especialmente 칰til cuando necesitas diferentes conjuntos de rutas para desarrollo, pruebas y producci칩n.

### Configuraci칩n espec칤fica por entorno

<Code code={`<?php
// config/ziggy.php

return [
    // Configuraci칩n base para todos los entornos
    'only' => [
        'login',
        'home',
        'products.*',
    ],
    
    // Configuraciones espec칤ficas por entorno
    'production' => [
        'except' => [
            'debug.*',
            'telescope.*',
        ],
    ],
    
    'local' => [
        'only' => [
            'login',
            'home',
            'products.*',
            'debug.*',  // Incluir rutas de depuraci칩n solo en local
            'telescope.*',
        ],
    ],
];
`} lang="php" title="Configuraci칩n por entorno" />

### Uso con middleware

Puedes combinar Ziggy con middleware para controlar qu칠 rutas se exponen seg칰n el usuario autenticado:

<Code code={`<?php
// app/Http/Middleware/ZiggyRoutesMiddleware.php

namespace App\Http\Middleware;

use Closure;
use Illuminate\Http\Request;
use Tightenco\Ziggy\Ziggy;

class ZiggyRoutesMiddleware
{
    public function handle(Request $request, Closure $next)
    {
        // Determinar qu칠 grupo de rutas usar seg칰n el usuario
        $group = $request->user() && $request->user()->isAdmin()
            ? 'admin'
            : 'public';
            
        // Compartir las rutas con la vista
        view()->share('ziggy', new Ziggy($group));
        
        return $next($request);
    }
}
`} lang="php" title="Middleware para Ziggy" />

Registra el middleware en `app/Http/Kernel.php`:

```php
protected $middlewareGroups = [
    'web' => [
        // Otros middleware...
        \App\Http\Middleware\ZiggyRoutesMiddleware::class,
    ],
];
```

## Configuraci칩n para entornos multiling칲es

Ziggy ofrece soporte para aplicaciones multiling칲es, permiti칠ndote generar URLs que respeten el idioma actual de la aplicaci칩n.

### Habilitar soporte multiling칲e

<Code code={`<?php
// config/ziggy.php

return [
    // Habilitar soporte para localizaci칩n
    'locale' => true,
    
    // O especificar un locale por defecto
    'locale' => 'es',
];
`} lang="php" title="Configuraci칩n multiling칲e" />

### Uso con prefijos de idioma en las rutas

Si tu aplicaci칩n utiliza prefijos de idioma en las URLs (como `/es/productos` o `/en/products`), Ziggy puede manejar esto autom치ticamente:

<Tabs>
  <TabItem label="Configuraci칩n de rutas">
    ```php
    // routes/web.php
    Route::prefix('{locale}')
        ->middleware('locale')
        ->group(function () {
            Route::get('products', 'ProductController@index')
                ->name('products.index');
        });
    ```
  </TabItem>
  
  <TabItem label="Middleware de localizaci칩n">
    ```php
    // app/Http/Middleware/LocaleMiddleware.php
    namespace App\Http\Middleware;
    
    use Closure;
    use Illuminate\Support\Facades\App;
    
    class LocaleMiddleware
    {
        public function handle($request, Closure $next)
        {
            $locale = $request->route('locale');
            App::setLocale($locale);
            
            return $next($request);
        }
    }
    ```
  </TabItem>
  
  <TabItem label="Uso en JavaScript">
    ```js
    // Ziggy generar치 la URL con el locale actual
    const url = route('products.index'); // /es/products (si el locale es 'es')
    
    // O puedes especificar un locale diferente
    const url = route('products.index', {}, {}, 'en'); // /en/products
    ```
  </TabItem>
</Tabs>

### Cambio din치mico de idioma

<Code code={`// Componente de selector de idioma
import { ref, watch } from 'vue';
import route from 'ziggy-js';

export default {
  setup() {
    const currentLocale = ref('es');
    
    const changeLocale = (newLocale) => {
      currentLocale.value = newLocale;
      
      // Redirigir a la misma p치gina pero con el nuevo idioma
      const currentRouteName = route().current();
      const currentParams = route().params;
      
      if (currentRouteName) {
        window.location.href = route(currentRouteName, currentParams, {}, newLocale);
      }
    };
    
    return {
      currentLocale,
      changeLocale
    };
  }
};
`} lang="js" title="Selector de idioma con Ziggy" />

<Aside type="note">
  <p>Ziggy respeta la configuraci칩n de localizaci칩n de Laravel. Si cambias el idioma con <code>App::setLocale('en')</code>, Ziggy generar치 las URLs con ese idioma.</p>
</Aside>

## Personalizaci칩n avanzada del objeto Ziggy

Puedes extender o modificar el objeto Ziggy antes de pasarlo al frontend para casos de uso espec칤ficos:

<Code code={`<?php
// En un Service Provider o middleware

use Tightenco\Ziggy\Ziggy;

$ziggy = new Ziggy;

// A침adir datos personalizados al objeto Ziggy
$ziggy->customData = [
    'user' => auth()->user() ? [
        'id' => auth()->user()->id,
        'permissions' => auth()->user()->permissions->pluck('name'),
    ] : null,
    'settings' => [
        'enableFeatureX' => config('features.x_enabled'),
        'apiTimeout' => config('api.timeout'),
    ],
];

// Compartir con la vista
view()->share('ziggy', $ziggy);
`} lang="php" title="Personalizaci칩n del objeto Ziggy" />

Luego, en JavaScript:

```js
// Acceder a los datos personalizados
console.log(Ziggy.customData.settings.enableFeatureX);

// Comprobar permisos del usuario
const hasPermission = (permission) => {
  return Ziggy.customData.user && 
         Ziggy.customData.user.permissions.includes(permission);
};

if (hasPermission('edit-users')) {
  // Mostrar opciones de edici칩n
}
```

<Aside type="caution">
  <p>Ten cuidado con los datos que a침ades al objeto Ziggy, ya que estar치n disponibles p칰blicamente en el frontend. Nunca incluyas informaci칩n sensible como tokens o credenciales.</p>
</Aside>

## Resumen de configuraci칩n avanzada

<Tabs>
  <TabItem label="Seguridad">
    <Badge text="Importante" variant="danger" />
    
    - Usa `only` para limitar las rutas expuestas al frontend
    - Nunca expongas rutas administrativas o sensibles a usuarios no autorizados
    - Considera usar middleware para filtrar rutas seg칰n el usuario
    - No a침adas informaci칩n sensible al objeto Ziggy
  </TabItem>
  
  <TabItem label="Rendimiento">
    <Badge text="Optimizaci칩n" variant="success" />
    
    - Limita el n칰mero de rutas exportadas para reducir el tama침o del objeto JavaScript
    - Usa grupos para cargar solo las rutas necesarias en cada parte de la aplicaci칩n
    - Considera generar archivos JavaScript separados para diferentes secciones
  </TabItem>
  
  <TabItem label="Organizaci칩n">
    <Badge text="Buenas pr치cticas" variant="note" />
    
    - Agrupa las rutas seg칰n su prop칩sito (p칰blicas, admin, API)
    - Usa configuraciones espec칤ficas por entorno
    - Documenta la estructura de tus rutas para facilitar el mantenimiento
  </TabItem>
</Tabs>
